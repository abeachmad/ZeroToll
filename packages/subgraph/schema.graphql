type GasSettlement @entity {
  id: ID!
  user: Bytes!
  feeToken: Bytes!              # token used for fee payment
  feeMode: String!              # NATIVE, INPUT, OUTPUT, STABLE
  costInFeeToken: BigInt!       # actual cost in fee token units
  refundInFeeToken: BigInt!     # refund amount in fee token units
  oracleSource: String!         # Pyth, TWAP, Chainlink
  priceAgeSec: Int              # oracle price age in seconds
  timestamp: BigInt!
  blockNumber: BigInt!
  txHash: Bytes!
}

type RouteExecution @entity {
  id: ID!
  intentId: Bytes!
  tokenIn: Bytes!
  tokenOut: Bytes!
  amountIn: BigInt!
  amountOut: BigInt!
  netOut: BigInt!               # after fee deduction (if OUTPUT mode)
  srcChainId: BigInt!
  dstChainId: BigInt!
  feeMode: String!
  timestamp: BigInt!
}

type FillRecord @entity {
  id: ID!
  intentId: Bytes!
  relayer: Bytes!
  costNative: BigInt!
  feeToken: Bytes!
  feeAmount: BigInt!
  refundAmount: BigInt!
  latencyMs: BigInt!
  status: String!               # success, pending, failed
  timestamp: BigInt!
}

type FeeDistribution @entity {
  id: ID!
  lpAmount: BigInt!
  relayerAmount: BigInt!
  treasuryAmount: BigInt!
  feeToken: Bytes!
  timestamp: BigInt!
}

type DailyMetrics @entity {
  id: ID!                       # date string YYYY-MM-DD
  totalSwaps: Int!
  successfulSwaps: Int!
  failedSwaps: Int!
  totalVolumeUSD: BigDecimal!
  totalFeesUSD: BigDecimal!
  totalRefundsUSD: BigDecimal!
  gasSavedUSD: BigDecimal!
  uniqueUsers: Int!
  avgFeeUSD: BigDecimal!
  nativeModeCount: Int!
  inputModeCount: Int!
  outputModeCount: Int!
  stableModeCount: Int!
  date: BigInt!
}

type GlobalStats @entity {
  id: ID!                       # singleton "global"
  totalSwaps: BigInt!
  successfulSwaps: BigInt!
  totalVolumeUSD: BigDecimal!
  totalFeesUSD: BigDecimal!
  totalRefundsUSD: BigDecimal!
  gasSavedUSD: BigDecimal!
  uniqueUsers: BigInt!
  supportedTokens: Int!
  lastUpdated: BigInt!
}
